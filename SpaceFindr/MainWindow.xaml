<Window x:Class="SpaceFindr.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:SpaceFindr"
        mc:Ignorable="d"
        Title="SpaceFindr BETA" Height="900" Width="1600"
        SizeChanged="Window_SizeChanged">
    <Window.Resources>
        <Style x:Key="UpArrowPathStyle" TargetType="Path">
            <Setter Property="Stroke" Value="#444444"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding IsEnabled, RelativeSource={RelativeSource AncestorType=Button}}" Value="False">
                    <Setter Property="Stroke" Value="#888888"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
        <Style x:Key="BreadcrumbButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="4">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#E0E7F8"/>
                                <Setter Property="BorderBrush" Value="#B4C7E7"/>
                            </Trigger>
                            <Trigger Property="IsKeyboardFocused" Value="True">
                                <Setter Property="BorderBrush" Value="#3399FF"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="BrowseButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#DDDDDD"/>
            <Setter Property="BorderBrush" Value="#CCCCCC"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="12,0"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="6">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#E0E7F8"/>
                                <Setter Property="BorderBrush" Value="#B4C7E7"/>
                            </Trigger>
                            <Trigger Property="IsKeyboardFocused" Value="True">
                                <Setter Property="BorderBrush" Value="#3399FF"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <Border x:Name="TipBar" ToolTip="You can turn off tips in the settings menu" Grid.Row="0" Background="#E3F2FD" Padding="12,4" CornerRadius="4" Margin="0,0,0,10" Visibility="Visible">
            <DockPanel>
                <TextBlock Text="TIP: You can use the select folder option to scan drives on other computers in the network if they are shared with you" Foreground="#1565C0" FontWeight="SemiBold" FontSize="14" VerticalAlignment="Center"/>
                <Button x:Name="TipBarCloseButton" DockPanel.Dock="Right" Width="28" Height="28" Margin="8,0,0,0" VerticalAlignment="Center" HorizontalAlignment="Right" Background="Transparent" BorderThickness="0" Click="TipBarCloseButton_Click">
                    <TextBlock Text="✕" FontSize="16" Foreground="#1565C0" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                </Button>
            </DockPanel>
        </Border>
        <WrapPanel x:Name="DrivesPanel" Orientation="Horizontal" Grid.Row="1" HorizontalAlignment="Left" Margin="0,0,0,10"/>
        <Grid Grid.Row="2" Margin="0,0,0,10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <StackPanel Orientation="Horizontal" Grid.Column="0">
                <Button x:Name="BrowseButton" Content="Select Folder" Width="150" Height="40" Margin="0,0,10,0"
                        Click="BrowseButton_Click" Style="{StaticResource BrowseButtonStyle}"
                        ToolTip="Scan a folder or drive (Ctrl+O)" />
                <Button x:Name="UpButton" Width="30" Height="30" Margin="0,0,10,0"
                        Click="UpButton_Click" Style="{StaticResource BrowseButtonStyle}"
                        ToolTip="Go to parent folder">
                    <Path Data="M 20,28 L 20,12 M 12,20 L 20,12 L 28,20"
                          StrokeThickness="2"
                          Style="{StaticResource UpArrowPathStyle}"
                          Fill="Transparent"
                          Stretch="Uniform"
                          Width="15" Height="15"
                          HorizontalAlignment="Center" VerticalAlignment="Center" />
                </Button>
            </StackPanel>
            <Border x:Name="BreadcrumbBarBorder" Background="#F5F5F5" Padding="8,0" Height="40" VerticalAlignment="Center"
                    BorderBrush="#B4C7E7" BorderThickness="1" CornerRadius="6" MouseDown="BreadcrumbBar_MouseDown"
                    Visibility="Collapsed" Grid.Column="1">
                <Grid>
                    <StackPanel x:Name="BreadcrumbPanel" Orientation="Horizontal" VerticalAlignment="Center" Height="40"
                                HorizontalAlignment="Left" Visibility="Visible" />
                    <TextBox x:Name="BreadcrumbPathBox" VerticalAlignment="Center" Height="28" Margin="2,0,2,0"
                             Visibility="Collapsed" KeyDown="BreadcrumbPathBox_KeyDown" LostFocus="BreadcrumbPathBox_LostFocus"/>
                </Grid>
            </Border>
        </Grid>
        <Grid Grid.Row="3">
            <TabControl x:Name="MainTabControl" SelectionChanged="MainTabControl_SelectionChanged">
                <TabItem Header="Treemap">
                    <Border BorderBrush="Gray" BorderThickness="1" CornerRadius="6">
                        <Canvas x:Name="TreemapCanvas" Background="#FAFAFA"/>
                    </Border>
                </TabItem>
                <TabItem Header="Largest Files">
                    <Border BorderBrush="Gray" BorderThickness="1" CornerRadius="6">
                        <ListView x:Name="FilesListView" Margin="0" FontFamily="Consolas" FontSize="13">
                            <ListView.ContextMenu>
                                <ContextMenu>
                                    <MenuItem Header="Open" Click="File_Open_Click" />
                                    <MenuItem Header="Ask AI" Click="File_AskAI_Click" />
                                    <MenuItem Header="Delete" Click="File_Delete_Click" />
                                </ContextMenu>
                            </ListView.ContextMenu>
                            <ListView.View>
                                <GridView>
                                    <GridViewColumn Header="File Path" DisplayMemberBinding="{Binding FullPath}" Width="350"/>
                                    <GridViewColumn Header="Size" DisplayMemberBinding="{Binding SizeDisplay}" Width="100"/>
                                </GridView>
                            </ListView.View>
                        </ListView>
                    </Border>
                </TabItem>
                <TabItem Header="Settings">
                    <StackPanel Margin="16">
                        <!-- Display Settings -->
                        <TextBlock Text="Display" FontWeight="Bold" FontSize="14" Margin="0,0,0,8"/>
                        <!-- Treemap Subcategory -->
                        <TextBlock Text="Treemap" FontWeight="Bold" FontSize="13" Margin="8,8,0,8"/>
                        <CheckBox x:Name="ShowFreeSpaceCheckBox" Content="Show a free space square in the Treemap" IsChecked="True" Checked="ShowFreeSpaceCheckBox_Checked" Unchecked="ShowFreeSpaceCheckBox_Unchecked" Margin="24,0,0,0">
                            <CheckBox.ToolTip>
                                <ToolTip>
                                    <StackPanel MaxWidth="300">
                                        <TextBlock TextWrapping="Wrap" FontWeight="Bold" Margin="0,0,0,5">
                                            Show free space square in Treemap
                                        </TextBlock>
                                        <TextBlock TextWrapping="Wrap" Margin="0,0,0,5">
                                            When enabled, displays the available free space as a gray area in the treemap when viewing drive roots.
                                        </TextBlock>
                                        <TextBlock TextWrapping="Wrap" Margin="0,5,0,0" FontStyle="Italic">
                                            This helps you visualize how much storage space is still available on your drives alongside the used space.
                                        </TextBlock>
                                    </StackPanel>
                                </ToolTip>
                            </CheckBox.ToolTip>
                        </CheckBox>

                        <CheckBox x:Name="ShowChildFoldersInTreemapCheckBox" Content="Show subdirectories (Experimental)" IsChecked="False" Checked="ShowChildFoldersInTreemapCheckBox_Checked" Unchecked="ShowChildFoldersInTreemapCheckBox_Unchecked" Margin="24,0,0,0">
                            <CheckBox.ToolTip>
                                <ToolTip>
                                    <StackPanel MaxWidth="300">
                                        <TextBlock TextWrapping="Wrap" FontWeight="Bold" Margin="0,0,0,5">
                                            Show subdirectories
                                        </TextBlock>
                                        <TextBlock TextWrapping="Wrap" Margin="0,0,0,5">
                                            When enabled, the treemap will show up to 2 levels of subdirectories inside each folder rectangle.
                                        </TextBlock>
                                        <TextBlock TextWrapping="Wrap" Margin="0,5,0,0" FontStyle="Italic">
                                            This option is still very much experimental and may be a lot 
                                        </TextBlock>
                                    </StackPanel>
                                </ToolTip>
                            </CheckBox.ToolTip>
                        </CheckBox>
                        <!-- Drive list Subcategory -->
                        <TextBlock Text="Drive list" FontWeight="Bold" FontSize="13" Margin="8,16,0,8"/>
                        <CheckBox x:Name="SwitchUsedAndFreeCheckBox" Content="Swap used and free in drive view" IsChecked="False" Checked="SwitchUsedAndFreeCheckBox_Checked" Unchecked="SwitchUsedAndFreeCheckBox_Unchecked" Margin="24,0,0,0">
                            <CheckBox.ToolTip>
                                <ToolTip>
                                    <StackPanel MaxWidth="300">
                                        <TextBlock TextWrapping="Wrap" FontWeight="Bold" Margin="0,0,0,5">
                                            Swap used and free in drive view
                                        </TextBlock>
                                        <TextBlock TextWrapping="Wrap" Margin="0,0,0,5">
                                            When enabled, the drive info panel will show 'used of total' on top and 'free (percent)' below, instead of the default 'free of total' and 'used (percent)'.
                                        </TextBlock>
                                    </StackPanel>
                                </ToolTip>
                            </CheckBox.ToolTip>
                        </CheckBox>
                        <CheckBox x:Name="ShowUsedSpaceCheckBox" Content="Show used space on the drive list" IsChecked="False" Checked="ShowUsedSpaceCheckBox_Checked" Unchecked="ShowUsedSpaceCheckBox_Unchecked" Margin="24,0,0,0">
                            <CheckBox.ToolTip>
                                <ToolTip>
                                    <StackPanel MaxWidth="300">
                                        <TextBlock TextWrapping="Wrap" FontWeight="Bold" Margin="0,0,0,5">
                                            Show used space on drives
                                        </TextBlock>
                                        <TextBlock TextWrapping="Wrap" Margin="0,0,0,5">
                                            When enabled, displays the used space as a value in the drive info panel.
                                        </TextBlock>
                                        <TextBlock TextWrapping="Wrap" Margin="0,5,0,0" FontStyle="Italic">
                                            This helps you visualize how much storage space is already used on your drives.
                                        </TextBlock>
                                    </StackPanel>
                                </ToolTip>
                            </CheckBox.ToolTip>
                        </CheckBox>
                        <CheckBox x:Name="ShowRemovableDrivesCheckBox" Content="Show removable drives (USB, SD cards, etc.)" IsChecked="True" Checked="ShowRemovableDrivesCheckBox_Checked" Unchecked="ShowRemovableDrivesCheckBox_Unchecked" Margin="24,6,0,0">
                            <CheckBox.ToolTip>
                                <ToolTip>
                                    <StackPanel MaxWidth="300">
                                        <TextBlock TextWrapping="Wrap" FontWeight="Bold" Margin="0,0,0,5">
                                            Show removable drives
                                        </TextBlock>
                                        <TextBlock TextWrapping="Wrap" Margin="0,0,0,5">
                                            When enabled, SpaceFindr will display removable storage devices such as USB flash drives and SD cards in the drives list.
                                        </TextBlock>
                                        <TextBlock TextWrapping="Wrap" Margin="0,5,0,0" FontStyle="Italic">
                                            Disable this if you want to hide temporary or external drives.
                                        </TextBlock>
                                    </StackPanel>
                                </ToolTip>
                            </CheckBox.ToolTip>
                        </CheckBox>
                        <CheckBox x:Name="ShowNetworkDrivesCheckBox" Content="Show network drives (mapped drives, shares)" IsChecked="True" Checked="ShowNetworkDrivesCheckBox_Checked" Unchecked="ShowNetworkDrivesCheckBox_Unchecked" Margin="24,0,0,0">
                            <CheckBox.ToolTip>
                                <ToolTip>
                                    <StackPanel MaxWidth="300">
                                        <TextBlock TextWrapping="Wrap" FontWeight="Bold" Margin="0,0,0,5">
                                            Show network drives
                                        </TextBlock>
                                        <TextBlock TextWrapping="Wrap" Margin="0,0,0,5">
                                            When enabled, SpaceFindr will display network drives and mapped network shares in the drives list.
                                        </TextBlock>
                                        <TextBlock TextWrapping="Wrap" Margin="0,5,0,0" FontStyle="Italic">
                                            Disable this if you want to hide network storage.
                                        </TextBlock>
                                    </StackPanel>
                                </ToolTip>
                            </CheckBox.ToolTip>
                        </CheckBox>
                        <!-- Misc Subcategory -->
                        <TextBlock Text="Miscellaneous" FontWeight="Bold" FontSize="13" Margin="8,16,0,8"/>
                        <CheckBox x:Name="ShowTipsCheckBox" Content="Show tips for using SpaceFindr" IsChecked="True" Checked="ShowTipsCheckBox_Checked" Unchecked="ShowTipsCheckBox_Unchecked" Margin="24,0,0,0">
                            <CheckBox.ToolTip>
                                <ToolTip>
                                    <StackPanel MaxWidth="300">
                                        <TextBlock TextWrapping="Wrap" FontWeight="Bold" Margin="0,0,0,5">
                                            Show tips for using SpaceFindr
                                        </TextBlock>
                                        <TextBlock TextWrapping="Wrap" Margin="0,0,0,5">
                                            When enabled, helpful tips will be displayed at the top of the application to guide you in using SpaceFindr.
                                        </TextBlock>
                                        <TextBlock TextWrapping="Wrap" Margin="0,5,0,0" FontStyle="Italic">
                                            Disable this if you do not want to see application tips.
                                        </TextBlock>
                                    </StackPanel>
                                </ToolTip>
                            </CheckBox.ToolTip>
                        </CheckBox>

                        <!-- Scanning Behavior -->
                        <TextBlock Text="Scanning Behavior" FontWeight="Bold" FontSize="14" Margin="0,20,0,8"/>
                        <CheckBox x:Name="IgnoreReparsePointsCheckBox" Content="Ignore reparse-point-based links (symbolic links, junctions, cloud files etc.)" IsChecked="True" Checked="IgnoreReparsePointsCheckBox_Checked" Unchecked="IgnoreReparsePointsCheckBox_Unchecked" Margin="16,0,0,0">
                            <CheckBox.ToolTip>
                                <ToolTip>
                                    <StackPanel MaxWidth="300">
                                        <TextBlock TextWrapping="Wrap" FontWeight="Bold" Margin="0,0,0,5">
                                            What are reparse-point-based links?
                                        </TextBlock>
                                        <TextBlock TextWrapping="Wrap" Margin="0,0,0,5">
                                            • Symbolic links: Special files that point to another file or folder
                                        </TextBlock>
                                        <TextBlock TextWrapping="Wrap" Margin="0,0,0,5">
                                            • Junctions: Windows directory links that redirect to another location
                                        </TextBlock>
                                        <TextBlock TextWrapping="Wrap" Margin="0,0,0,5">
                                            • Cloud files: OneDrive, Dropbox, or other cloud storage placeholders
                                        </TextBlock>
                                        <TextBlock TextWrapping="Wrap" Margin="0,5,0,0" FontStyle="Italic">
                                            When enabled: These links are skipped during scanning to avoid counting the same data twice or scanning virtual/placeholder files.
                                        </TextBlock>
                                    </StackPanel>
                                </ToolTip>
                            </CheckBox.ToolTip>
                        </CheckBox>

                        <!-- Update Settings -->
                        <TextBlock Text="Updates" FontWeight="Bold" FontSize="14" Margin="0,20,0,8"/>
                        <CheckBox x:Name="CheckUpdatesOnStartCheckBox" Content="Check for updates on start" IsChecked="True" Checked="CheckUpdatesOnStartCheckBox_Checked" Unchecked="CheckUpdatesOnStartCheckBox_Unchecked" Margin="16,0,0,0">
                            <CheckBox.ToolTip>
                                <ToolTip>
                                    <StackPanel MaxWidth="300">
                                        <TextBlock TextWrapping="Wrap" FontWeight="Bold" Margin="0,0,0,5">
                                            Check for updates on startup
                                        </TextBlock>
                                        <TextBlock TextWrapping="Wrap" Margin="0,0,0,5">
                                            When enabled, SpaceFindr will automatically check for newer versions on GitHub when the application starts.
                                        </TextBlock>
                                        <TextBlock TextWrapping="Wrap" Margin="0,5,0,0" FontStyle="Italic">
                                            If a newer version is found, you'll be notified with a dialog showing the latest release information.
                                        </TextBlock>
                                    </StackPanel>
                                </ToolTip>
                            </CheckBox.ToolTip>
                        </CheckBox>
                    </StackPanel>
                </TabItem>
            </TabControl>
        </Grid>
        <StatusBar Grid.Row="4" Height="28" VerticalAlignment="Bottom"
                   Background="#E3F2FD" BorderThickness="0" Padding="8,0">
            <StatusBarItem>
                <local:Spinner x:Name="ScanningSpinner" Visibility="Collapsed" Margin="0,0,8,0" />
            </StatusBarItem>
            <StatusBarItem>
                <TextBlock x:Name="FolderFileCountText" Text="Items: 0 folders, 0 files" Foreground="#1565C0" />
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Right">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Foreground="#1565C0">
                        <Hyperlink NavigateUri="https://popeen.com" RequestNavigate="Hyperlink_RequestNavigate">popeen.com</Hyperlink>
                    </TextBlock>
                    <TextBlock Text="  " />
                    <TextBlock Foreground="#1565C0" FontSize="15" VerticalAlignment="Center">❤️</TextBlock>
                    <TextBlock Foreground="#1565C0" Margin="4,0,0,0">
                        <Hyperlink NavigateUri="https://donations.popeen.com/" RequestNavigate="Hyperlink_RequestNavigate">Buy me a coffee</Hyperlink>
                    </TextBlock>
                </StackPanel>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
